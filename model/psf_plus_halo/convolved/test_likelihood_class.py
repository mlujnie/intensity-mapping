import my_likelihood_plus as ml
import glob
import numpy as np
import sys

bello = ml.LaeLikePlus()
print("Initializing worked.")

print(bello.lae_ids)
print("getting the lae_ids worked")

print(bello.shot_ids)
print("number of shots: ", len(np.unique(bello.shot_ids)))
print("getting the shotid worked")

for shot in np.unique(bello.shot_ids):
	print(glob.glob(f"/work/05865/maja_n/stampede2/master/chains-laes/psf_{shot}"))

print("flus: ", bello.starflux.dtype)
print("err: ", bello.starsigma.dtype)
print("dist: ", bello.stardists.dtype)

kwargs = {'Apow_2101631009': 0.2325126233992842,
'Apow_2101631050': -0.06730443387850125,
'Apow_2101631071': -0.05220766292889626,
'Apow_2101631559': 0.09974713867696916,
'Apow_2101672484': -0.08731168229664828,
'Apow_2101672485': -0.04902941402485035,
'Apow_2101672617': -0.03976116232293275,
'Apow_2101673331': -0.09244909132967914,
'Apow_2101673663': 0.041144794995688266,
'Apow_2101673816': -0.1752766713072301,
'Apow_2101673838': -0.2386442790256883,
'Apow_2101673839': -0.08299096432513045,
'Apow_2101673951': -0.18161381898972942,
'Apow_2101674072': -0.26031335810458706,
'Apow_2101674073': -0.08323076051187955,
'Apow_2101674318': -0.05465147983804883,
'Apow_2101674450': 0.12190870648765859,
'Apow_2101836393': 0.12346914678647351,
'Apow_2101836931': 0.36750013692576733,
'Apow_2101837505': -0.2109090920319758,
'Apow_2101837533': -0.15448141902592769,
'Apow_2101837537': -0.15310126875628444,
'Apow_2101837667': -0.18380795126143165,
'Apow_2101840888': -0.09340884637038786,
'Apow_2101841298': 0.03595649159261909,
'Apow_2101841589': -0.045808487029806055,
'Apow_2101841674': 0.17053877698331338,
'Apow_2101842400': -0.05863731491514245,
'Apow_2101842587': -0.15339818675896574,
'Apow_2101843013': -0.38211933424711514,
'Apow_2101843014': -0.034665167021115634,
'Apow_2101843064': -0.14195006327027293,
'Apow_2102122883': 0.13673470084326073,
'Apow_2102123057': -0.13759765654383527,
'Apow_2102123117': -0.14863268773505386,
'Apow_2102123273': -0.05874988298350487,
'Apow_2102123519': 0.041619421419631354,
'Apow_2102123601': 0.16888739398135028,
'Apow_2102123603': 0.062424318057313896,
'Apow_2102123740': 0.06399605324208765,
'Apow_2102127307': -0.0776356376122097,
'Apow_2102127383': 0.08451441890550637,
'Apow_2102127386': 0.054777167256787156,
'Apow_2102127462': 0.10893383692729472,
'Apow_2102127483': -0.2271876445686617,
'Apow_2102208632': -0.15550667913191282,
'Apow_2102208844': -0.1525668159794422,
'Apow_2102210776': -0.1310745457370864,
'Apow_2102565324': 0.18120163853605697,
'Apow_2102565446': 0.03418963307589179,
'Apow_2102565940': -0.2712754585210678,
'Apow_2102565964': 0.053760052515743326,
'Apow_2102566285': 0.26104469402386404,
'Apsf_2101631009': 3.90718631084178,
'Apsf_2101631050': 3.0383915360179454,
'Apsf_2101631071': 4.319729526501782,
'Apsf_2101631559': 4.208263848311644,
'Apsf_2101672484': 4.205749237519133,
'Apsf_2101672485': 4.150133315960141,
'Apsf_2101672617': 2.890226526520886,
'Apsf_2101673331': 1.9121328730590355,
'Apsf_2101673663': 2.555401063626761,
'Apsf_2101673816': 3.1360326317034874,
'Apsf_2101673838': 4.061073336855888,
'Apsf_2101673839': 2.546609015203887,
'Apsf_2101673951': 4.028896963059072,
'Apsf_2101674072': 9.902973119435972,
'Apsf_2101674073': 2.5339381283132747,
'Apsf_2101674318': 3.7789210136226283,
'Apsf_2101674450': 4.587188533595789,
'Apsf_2101836393': 4.248693142104161,
'Apsf_2101836931': 6.310073723820866,
'Apsf_2101837505': 6.0429298244824405,
'Apsf_2101837533': 9.215520344804805,
'Apsf_2101837537': 4.8719287123300345,
'Apsf_2101837667': 4.540424406051476,
'Apsf_2101840888': 2.637872682124035,
'Apsf_2101841298': 6.899848609494109,
'Apsf_2101841589': 3.658426268861046,
'Apsf_2101841674': 9.326406772462077,
'Apsf_2101842400': 5.672704770007813,
'Apsf_2101842587': 4.63147663254476,
'Apsf_2101843013': 6.148518992111734,
'Apsf_2101843014': 5.294688428441788,
'Apsf_2101843064': 5.202698412634929,
'Apsf_2102122883': 5.311033172069006,
'Apsf_2102123057': 4.832848403175706,
'Apsf_2102123117': 3.8828819546364532,
'Apsf_2102123273': 15.01341188559425,
'Apsf_2102123519': 4.252094688919876,
'Apsf_2102123601': 10.754491403178829,
'Apsf_2102123603': 11.306388092712599,
'Apsf_2102123740': 3.9134829148982684,
'Apsf_2102127307': 3.4733827208899473,
'Apsf_2102127383': 5.50220725742931,
'Apsf_2102127386': 4.204386408433483,
'Apsf_2102127462': 2.6940219174901094,
'Apsf_2102127483': 7.652822020277153,
'Apsf_2102208632': 6.732791473677884,
'Apsf_2102208844': 5.1024593948904915,
'Apsf_2102210776': 4.074653963886905,
'Apsf_2102565324': 3.916808755568387,
'Apsf_2102565446': 3.196018418446837,
'Apsf_2102565940': 3.31766633927038,
'Apsf_2102565964': 5.01491831598279,
'Apsf_2102566285': 4.377224959575603,
'fwhm_20200107026': 1.5129507016650778,
'fwhm_20200124019': 1.6836962629434944,
'fwhm_20200124020': 1.6585274099041531,
'fwhm_20200228022': 1.5589462792627786,
'fwhm_20200228026': 1.5804663028624688,
'fwhm_20200228027': 1.5027946597487458,
'fwhm_20200425010': 1.5186653809961914,
'fwhm_20200425013': 1.5321399416496786,
'fwhm_20200430025': 1.6177409452947493,
'fwhm_20200430026': 1.5898157988592412,
'fwhm_20200626016': 1.5746913331470684}

for shot in bello.shot_ids:
	kwargs[f'fwhm_{shot}'] = 1.5

for laeid in bello.lae_ids:
	kwargs[f'Apow_{laeid}'] = 2
	kwargs[f'Apsf_{laeid}'] = 2
	

#for shot in bello.shot_ids:
#	kwargs[f"fwhm_{shot}"] = 1.5
#kwargs["A_pow"] = 1.0

print("likelihood test: ", bello.logp(**kwargs))
print("computing likelihood succeeded.")
